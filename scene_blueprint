blueprint:
  name: Cycle Through Scenes with Button
  description: Cycles through up to 5 scenes when a button helper is pressed.
  domain: automation
  input:
    button_helper:
      name: Button Helper
      description: The button helper to trigger scene cycling.
      selector:
        entity:
          domain: input_button
    scene_1:
      name: Scene 1
      selector:
        entity:
          domain: scene
    scene_2:
      name: Scene 2
      selector:
        entity:
          domain: scene
    scene_3:
      name: Scene 3 (Optional)
      default: ""
      selector:
        entity:
          domain: scene
          multiple: false
    scene_4:
      name: Scene 4 (Optional)
      default: ""
      selector:
        entity:
          domain: scene
          multiple: false
    scene_5:
      name: Scene 5 (Optional)
      default: ""
      selector:
        entity:
          domain: scene
          multiple: false
  variables:
    scenes:
      - !input scene_1
      - !input scene_2
      - !input scene_3
      - !input scene_4
      - !input scene_5
    scenes_filtered: "{{ scenes | select('string') | list }}"
  trigger:
    - platform: state
      entity_id: !input button_helper
  action:
    - variables:
        scene_count: "{{ scenes_filtered | count }}"
        current_scene_index: >-
          {% set current = states('input_number.scene_cycle_index') | int %}
          {{ (current + 1) % scene_count }}
    - service: input_number.set_value
      target:
        entity_id: input_number.scene_cycle_index
      data:
        value: "{{ current_scene_index }}"
    - service: scene.turn_on
      target:
        entity_id: "{{ scenes_filtered[current_scene_index] }}"
mode: restart
